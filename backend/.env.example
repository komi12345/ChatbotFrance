# =============================================================================
# CONFIGURATION BACKEND - CHATBOT WHATSAPP
# =============================================================================
# Copiez ce fichier vers .env et remplissez les valeurs
# cp .env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# ENVIRONNEMENT
# -----------------------------------------------------------------------------
# Mode d'exécution : development | production | testing
ENVIRONMENT=development

# Active le mode debug (logs détaillés, rechargement automatique)
# ATTENTION : Désactiver en production !
DEBUG=True

# -----------------------------------------------------------------------------
# CONFIGURATION API
# -----------------------------------------------------------------------------
# Adresse d'écoute du serveur (0.0.0.0 pour toutes les interfaces)
API_HOST=0.0.0.0

# Port d'écoute du serveur
API_PORT=8000

# -----------------------------------------------------------------------------
# SUPABASE / POSTGRESQL
# -----------------------------------------------------------------------------
# URL de votre projet Supabase
# Trouvez-la dans : Supabase Dashboard > Settings > API > Project URL
SUPABASE_URL=https://your-project.supabase.co

# Clé publique (anon key) - utilisée côté client
# Trouvez-la dans : Supabase Dashboard > Settings > API > anon public
SUPABASE_KEY=your_anon_key

# Clé de service (service_role key) - CONFIDENTIELLE, côté serveur uniquement
# Trouvez-la dans : Supabase Dashboard > Settings > API > service_role
# ATTENTION : Ne jamais exposer cette clé côté client !
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# URL de connexion PostgreSQL directe
# Format : postgresql://user:password@host:port/database
# Trouvez-la dans : Supabase Dashboard > Settings > Database > Connection string
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# =============================================================================
# WASSENGER API 2025 - NOUVELLE INTÉGRATION
# =============================================================================
# Documentation : https://wassenger.com/docs
# Wassenger permet d'envoyer des messages WhatsApp via une API REST simple.
# Connectez votre WhatsApp Business via QR code dans le dashboard Wassenger.

# Clé API Wassenger (OBLIGATOIRE)
# Trouvez-la dans : Wassenger Dashboard > Settings > API Keys
# Format : commence par "wsp_live_" ou "wsp_test_"
# Exemple : wsp_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WASSENGER_API_KEY=your_wassenger_api_key

# ID de l'appareil WhatsApp connecté (OBLIGATOIRE)
# Trouvez-le dans : Wassenger Dashboard > Devices
# C'est l'identifiant unique de votre appareil WhatsApp connecté
# Exemple : 64a1b2c3d4e5f6g7h8i9j0k1
WASSENGER_DEVICE_ID=your_wassenger_device_id

# URL du webhook pour recevoir les notifications Wassenger
# En développement local avec ngrok : https://votre-url.ngrok.io/api/webhooks/wassenger
# En production : https://votre-domaine.com/api/webhooks/wassenger
# Configurez cette URL dans : Wassenger Dashboard > Webhooks
WASSENGER_WEBHOOK_URL=https://your-ngrok-url.ngrok.io/api/webhooks/wassenger

# =============================================================================
# TWILIO WHATSAPP SANDBOX (DÉPRÉCIÉ - conservé pour référence)
# =============================================================================
# Documentation : https://www.twilio.com/docs/whatsapp/sandbox
# Ces variables ne sont plus utilisées depuis la migration vers Wassenger.
# Conservées pour référence en cas de besoin de rollback.

# Account SID Twilio (DÉPRÉCIÉ)
# Trouvez-le dans : Twilio Console > Account Info
# Format : commence par "AC" suivi de 32 caractères hexadécimaux
# TWILIO_ACCOUNT_SID=your_twilio_account_sid

# Auth Token Twilio (DÉPRÉCIÉ, SECRET)
# Trouvez-le dans : Twilio Console > Account Info (cliquez sur "Show")
# TWILIO_AUTH_TOKEN=your_twilio_auth_token

# Numéro Sandbox Twilio (par défaut: +14155238886)
# TWILIO_SANDBOX_NUMBER=+14155238886

# URL de base pour les webhooks Twilio
# TWILIO_WEBHOOK_BASE_URL=https://your-ngrok-url.ngrok.io

# =============================================================================
# ANCIENNES VARIABLES META (DÉPRÉCIÉ - conservées pour rétrocompatibilité)
# =============================================================================
# Ces variables ne sont plus utilisées depuis la migration vers Gupshup.
# Vous pouvez les supprimer ou les laisser vides.

# -----------------------------------------------------------------------------
# WHATSAPP BUSINESS API (META CLOUD API) - DÉPRÉCIÉ
# -----------------------------------------------------------------------------
# Identifiant du numéro de téléphone WhatsApp Business
# Trouvez-le dans : Meta Developers > WhatsApp > Configuration de l'API
WHATSAPP_PHONE_NUMBER_ID=your_phone_number_id

# Token d'accès pour l'API WhatsApp
# Générez-le dans : Meta Developers > WhatsApp > Configuration de l'API
# Pour un token permanent, créez un utilisateur système dans Meta Business Suite
WHATSAPP_ACCESS_TOKEN=your_access_token

# Token de vérification pour les webhooks (vous le définissez vous-même)
# Utilisez une chaîne aléatoire sécurisée
# Générer : python -c "import secrets; print(secrets.token_hex(16))"
WHATSAPP_WEBHOOK_VERIFY_TOKEN=your_webhook_verify_token

# Version de l'API WhatsApp (v18.0 recommandée)
WHATSAPP_API_VERSION=v18.0

# -----------------------------------------------------------------------------
# REDIS (MESSAGE BROKER CELERY)
# -----------------------------------------------------------------------------
# URL de connexion Redis
# Local : redis://localhost:6379/0
# Upstash (production) : rediss://default:password@endpoint.upstash.io:6379
REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# AUTHENTIFICATION JWT
# -----------------------------------------------------------------------------
# Clé secrète pour signer les tokens JWT
# IMPORTANT : Utilisez une clé forte et unique en production !
# Générer : python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your_super_secret_key_change_this_in_production_minimum_32_chars

# Algorithme de signature JWT (HS256 recommandé)
ALGORITHM=HS256

# Durée de validité du token d'accès (en minutes)
# 30 minutes est un bon compromis sécurité/UX
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Durée de validité du token de rafraîchissement (en jours)
REFRESH_TOKEN_EXPIRE_DAYS=7

# -----------------------------------------------------------------------------
# CORS (CROSS-ORIGIN RESOURCE SHARING)
# -----------------------------------------------------------------------------
# Origines autorisées à accéder à l'API (séparées par des virgules)
# Développement : http://localhost:3000
# Production : https://votre-app.vercel.app
ALLOWED_ORIGINS=http://localhost:3000

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
# Nombre maximum de requêtes API par minute par utilisateur
RATE_LIMIT_PER_MINUTE=100

# Limite d'envoi de messages WhatsApp par minute
# ATTENTION : Ne pas dépasser 25 pour respecter les limites Meta
WHATSAPP_RATE_LIMIT_PER_MINUTE=25

# -----------------------------------------------------------------------------
# CONFIGURATION DES RETRIES
# -----------------------------------------------------------------------------
# Nombre maximum de tentatives pour un message échoué
MAX_RETRY_ATTEMPTS=3

# Délai de base entre les retries (en secondes)
# Le délai augmente exponentiellement : 60s, 120s, 240s
RETRY_BASE_DELAY_SECONDS=60
